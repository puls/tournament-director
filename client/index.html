<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Tournament Director</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css">
    <style type="text/css">
    .nav a { cursor: pointer; }
    .container { margin-top: 1em; }
    .score-form td { vertical-align: middle; }
    form.modal { width: 950px; margin-left: -475px; }
    form.filterForm { margin-bottom: 0; }
    .filterForm input { width: 2em; margin: 0; }
    .modal-header .close { margin-left: 1em; }
    </style>
    <style type="text/css" media="screen">
    .printonly { display: none; }
    </style>
    <style type="text/css" media="print">
    .navbar, .nav, .filterForm { display: none; }
    .table td { padding: 2px; }
    </style>
  </head>
  <body>
    <script type="text/x-handlebars" data-template-name="application">
      <div class="container">
        {{ partial "navigation" }}
        {{ outlet }}
      </div>
    </script>
    <script type="text/x-handlebars" data-template-name="_navigation">
      <div class="navbar">
        <div class="navbar-inner">
          <span class="brand">{{ name }}</span>
          <ul class="nav">
          {{#linkTo "rounds" tagName="li" href=false}}
            <a {{bindAttr href="view.href"}}>Rounds</a>
          {{/linkTo}}
          {{#linkTo "teams" tagName="li" href=false}}
            <a {{bindAttr href="view.href"}}>Teams</a>
          {{/linkTo}}
          {{#linkTo "settings" tagName="li" href=false}}
            <a {{bindAttr href="view.href"}}>Settings</a>
          {{/linkTo}}
          {{#linkTo "standings" tagName="li" href=false}}
            <a {{bindAttr href="view.href"}}>Statistics</a>
          {{/linkTo}}
          </ul>
          <form class="navbar-search pull-right">
            <input type="text" class="search-query" placeholder="Search doesn't work yet">
          </form>
        </div>
      </div>
    </script>
    <script type="text/x-handlebars" data-template-name="standings">
    <ul class="nav nav-tabs">
      {{#linkTo "teamStandings" tagName="li" href=false}}
        <a {{bindAttr href="view.href"}}>Standings</a>
      {{/linkTo}}
      {{#linkTo "playerStandings" tagName="li" href=false}}
        <a {{bindAttr href="view.href"}}>Players</a>
      {{/linkTo}}
      {{#linkTo "scoreboard" tagName="li" href=false}}
        <a {{bindAttr href="view.href"}}>Scoreboard</a>
      {{/linkTo}}
    </ul>
    {{ outlet }}
    </script>
    <script type="text/x-handlebars" data-template-name="teamStandings">
    <h1 class="printonly">Team Standings</h1>
    <table class="table table-striped">
    <thead>
      <tr>
        <th></th>
        <th>Team</th>
        <th class="number">W</th>
        <th class="number">L</th>
        <th class="number">Pct</th>
        <th class="number">PF</th>
        <th class="number">(per game)</th>
        <th class="number">PA</th>
        <th class="number">(per game)</th>
        <th class="number">TUH</th>
        <th class="number">PP20H</th>
        <th class="number">P/bonus</th>
      </tr>
      </thead>
      <tbody>
      {{ resetCounter 'standings' }}
      {{#each controller.arrangedContent}}
        <tr>
          <td>{{ counter 'standings' }}.</td>
          <td>{{ key.[0] }}</td>
          <td class="number">{{ value.[0] }}</td>
          <td class="number">{{ value.[1] }}</td>
          <td class="number">{{ fixedDecimal value.[2] }}</td>
          <td class="number">{{ value.[3] }}</td>
          <td class="number">{{ fixedDecimal value.[4] }}</td>
          <td class="number">{{ value.[5] }}</td>
          <td class="number">{{ fixedDecimal value.[6] }}</td>
          <td class="number">{{ value.[7] }}</td>
          <td class="number">{{ fixedDecimal value.[8] }}</td>
          <td class="number">{{ fixedDecimal value.[11] }}</td>
        </tr>
      {{/each}}
      </tbody>
      </table>
    </script>
    <script type="text/x-handlebars" data-template-name="playerStandings">
    <h1 class="printonly">Player Standings</h1>
    <table class="table table-striped">
      <thead>
        <tr>
          <th></th>
          <th>Player</th>
          <th class="number">GP</th>
          <th class="number">TUH</th>
          <th class="number">15</th>
          <th class="number">10</th>
          <th class="number">-5</th>
          <th class="number">Pts</th>
          <th class="number">PP20H</th>
          <th class="number">TU/neg</th>
          <th class="number">neg/20H</th>
        </tr>
      </thead>
     <tbody>
     {{ resetCounter 'standings' }}
     {{#each controller.arrangedContent}}
       <tr>
         <td>{{ counter 'standings' }}.</td>
         <td>{{ key.[1] }}, {{ key.[0] }} ({{key.[2]}})</td>
         <td>{{ fixedDecimal value.[1] }}</td>
         <td>{{ value.[2] }}</td>
         <td>{{ value.[3] }}</td>
         <td>{{ value.[4] }}</td>
         <td>{{ value.[5] }}</td>
         <td>{{ value.[6] }}</td>
         <td>{{ fixedDecimal value.[7] }}</td>
         <td>{{ fixedDecimal value.[8] }}</td>
         <td>{{ fixedDecimal value.[9] }}</td>
       </tr>
     {{/each}}
     </tbody>
   </table>
  </script>
  <script type="text/x-handlebars" data-template-name="scoreboard">
  <h1 class="printonly">Scoreboard</h1>
  {{#each round in controller.rounds}}
    <h3>Round {{ round.id }}</h3>
    <div class="row">
    {{#each round.games}}
      <div class="span4">
        <table class="table table-condensed table-bordered">
          <tr><td>{{ [1] }}</td><td>{{ [2] }}</td></tr>
          <tr><td>{{ [3] }}</td><td>{{ [4] }}</td></tr>
        </table>
      </div>
    {{/each}}
    </div>
  {{/each}}
  </script>
  <script type="text/x-handlebars" data-template-name="settings">Settings</script>
    <script type="text/x-handlebars" data-template-name="teams">
    {{#each school in controller}}
    {{#each team in school.teams}}
    <h2>{{ team.name }}</h2>
    <ul>
    {{#each player in team.players}}
    <li>{{ player.name }}</li>
    {{/each}}
    </ul>
    {{/each}}
    {{/each}}
    </script>
    <script type="text/x-handlebars" data-template-name="school">
      {{#each controller.teams}}
      <h3>
        {{ name }}
        </h3>
      <ul>
      {{#each players}}
      <li>{{ name }}</li>
      {{/each}}
      </ul>
      {{/each}}
    </script>
    <script type="text/x-handlebars" data-template-name="rounds">
    <div class="row">
      <div class="span3">
        <div class="well well-small" style="padding: 8px 0">
          <ul class="nav nav-list">
            {{#with controller.pendingGames }}
            {{#linkTo "round" this tagName="li" href=false}}
              <a {{bindAttr href="view.href"}}>Pending Games <span class="badge badge-info pull-right">{{ gameCount }}</span></a>
            {{/linkTo}}
            <li class="divider"></li>
            {{/with}}
            {{#each controller}}
              {{#linkTo "round" this tagName="li" href=false}}
                <a {{bindAttr href="view.href"}}>Round {{ id }}</a>
              {{/linkTo}}
            {{/each}}
          </ul>
        </div>
      </div>
      <div class="span9">
      <h3>Enter a new game</h3>
      {{ view App.ScoreForm }}
      {{ outlet }}
      </div>
    </div>
    </script>
    <script type="text/x-handlebars" data-template-name="scoreForm">
    {{#with view.game}}
      <table class="table table-bordered">
        <tr>
          <td rowspan="2">{{view Ember.TextField valueBinding="round" class="round" style="width: 4em;" placeholder="Round" tabindex="1"}}</td>
          <td>{{view Ember.Select class="team1" tabindex="2" valueBinding="team1.id" contentBinding="App.Store.allTeams" optionValuePath="content.id" optionLabelPath="content.name" prompt="Left Team"}}</td>
          <td>{{view Ember.TextField valueBinding="team1.points" tabindex="4" placeholder="Pts" style="width: 4em;"}}</td>
          <td>{{view Ember.TextField valueBinding="tossups" tabindex="6" placeholder="TUH" style="width: 2em;"}}</td>
          <td>{{view Ember.TextField valueBinding="serial" tabindex="7" placeholder="Serial" style="width: 5em;"}}</td>
          <td rowspan="2"><button type="submit" class="btn btn-primary">Submit</button></td>
        </tr>
        <tr>
          <td>{{view Ember.Select class="team2" tabindex="3" valueBinding="team2.id" contentBinding="App.Store.allTeams" optionValuePath="content.id" optionLabelPath="content.name" prompt="Right Team"}}</td>
          <td>{{view Ember.TextField valueBinding="team2.points" tabindex="5" placeholder="Pts" style="width: 4em;"}}</td>
          <td colspan="2">{{view Ember.TextField valueBinding="room" tabindex="8" placeholder="Room" style="width: inherit"}}</td>
        </tr>
      </table>
    {{/with}}
    </script>
    <script type="text/x-handlebars" data-template-name="editGame">
    {{ view App.PlayersForm }}
    </script>
    <script type="text/x-handlebars" data-template-name="playersForm">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <span class="pull-right">
        Tossups: {{view App.NumberField valueBinding="tossups" style="width: 3em;"}}
        &nbsp; &nbsp; &nbsp;
        Serial: {{view Ember.TextField valueBinding="serial" style="width: 5em;"}}
        </span>
        <h3>Edit game</h3>
      </div>
      <div class="modal-body">
        {{#each team in teams}}
          <h4>{{ team.name }} {{view App.NumberField valueBinding="team.points" style="width: 3em;" class="pull-right"}}</h4>
          <table class="table table-bordered">
          <thead>
          <tr class="header">
            <th>Player</th>
            <th>TUH</th>
            <th>15</th>
            <th>10</th>
            <th>-5</th>
            <th>Pts</th>
          </tr>
          </thead>
          <tbody>
          {{#each player in team.players}}
            <tr>
              <td>{{view App.NameField valueBinding="player.name" teamBinding="team" class="player"}}</td>
              <td>{{view App.NumberField valueBinding="player.tossups" min="0" maxBinding="tossups" style="width: 3em;"}}</td>
              <td>{{view App.NumberField valueBinding="player.fifteens" min="0" maxBinding="tossups" style="width: 3em;"}}</td>
              <td>{{view App.NumberField valueBinding="player.tens" min="0" maxBinding="tossups" style="width: 3em;"}}</td>
              <td>{{view App.NumberField valueBinding="player.negFives" min="0" maxBinding="tossups" style="width: 3em;"}}</td>
              <td>{{ player.points }}</td>
            </tr>
          {{/each}}
          <tr>
            <td>Total</td>
            <td>{{ team.playerTossups }}</td>
            <td>{{ team.fifteens }}</td>
            <td>{{ team.tens }}</td>
            <td>{{ team.negFives }}</td>
            <td>{{ team.tossupPoints }} / {{ team.bonusPoints }}</td>
          </tr>
          </tbody>
          </table>
        {{/each}}
      </div>
      <div class="modal-footer">
        <a {{action deleteGame}} class="btn btn-danger pull-left">Delete Game</a>
        <a {{action cancel}} class="btn">Cancel</a>
        <a {{action save}} class="btn btn-primary">Save</a>
      </div>
    </script>
    <script type="text/x-handlebars" data-template-name="round">
    {{#if pending}}
      <h3>Pending Games</h3>
    {{else}}
      <h3>{{ games.length }} games from round {{ id }}</h3>
    {{/if}}
    <ul>
      {{#each game in controller.games}}
        <li>
          {{#if pending}}
            Round {{ game.round }}:
          {{else}}
            {{ game.serial }}:
          {{/if}}
          {{#linkTo "editGame" game}}{{ game.team1.name }} vs. {{ game.team2.name }}{{/linkTo}} in {{ game.room }}
        </li>
      {{/each}}
    </ul>
    {{ outlet }}
    </script>
    <script type="text/x-handlebars" data-template-name="filterForm">
      {{view Ember.Checkbox checkedBinding="filterRounds"}}
      Rounds {{view App.NumberField valueBinding="minRound"}} to {{view App.NumberField valueBinding="maxRound"}}
    </script>
    <script type="text/javascript" src="/js/libs/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="/js/libs/handlebars-1.0.0-rc.3.js"></script>
    <script type="text/javascript" src="/js/libs/ember-1.0.0-rc.3.js"></script>
    <script type="text/javascript" src="/js/libs/bootstrap.js"></script>
    <script type="text/javascript" src="/js/app.js"></script>
  </body>
</html>